---
import BaseLayout from '../layouts/BaseLayout.astro';
import WelcomeHero from '../components/WelcomeHero.svelte';
import HeroSlider from '../components/HeroSlider.svelte';
import '../styles/index.css';

const whatsappNumber = "237670358551";
const formspreeEndpoint = "https://formspree.io/f/xqedaepd";
---

<BaseLayout title="American Select - Quality Goods from USA & Canada">
  <!-- Welcome Section with Background Slideshow -->
  <WelcomeHero client:load whatsappNumber={whatsappNumber} />

  <!-- Category Slider -->
  <HeroSlider client:load />

  <section class="features section">
    <div class="container">
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">üåç</div>
          <h3>Sourced from USA & Canada</h3>
          <p>We provide direct access to a broad portfolio of high‚Äëquality products throughout our North American network, subject to certain exclusions within the electronics category</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">‚úÖ</div>
          <h3>Quality Assured</h3>
          <p>Every product is carefully selected and verified before import</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">üì¶</div>
          <h3>Essential Products</h3>
          <p>Focus on daily necessities that families need to survive and thrive</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">üíù</div>
          <h3>Trusted Service</h3>
          <p>Committed to quality and customer satisfaction with every order</p>
        </div>
      </div>
    </div>
  </section>

  <section class="cta section" style="background: var(--bg-light);">
    <div class="container">
      <div class="cta-content">
        <h2>Need Bulk Orders?</h2>
        <p>We offer special pricing for businesses and bulk purchases</p>
        <a href="/bulk-orders" class="btn">Contact Us for Bulk Orders</a>
      </div>
    </div>
  </section>

  <!-- Suggestion Box -->
  <section class="suggestion-box section">
    <div class="container">
      <div class="suggestion-content">
        <h2>We'd Love Your Feedback</h2>
        <p class="suggestion-intro">Help us improve your shopping experience. Share your ideas, product requests, or suggestions below. We review every submission and use your input to guide future updates.</p>

        <form class="suggestion-form" id="suggestionForm">
          <div class="form-group">
            <label for="name">Name <span class="optional">(optional)</span></label>
            <input type="text" id="name" name="name" placeholder="Your name">
          </div>

          <div class="form-group">
            <label for="email">Email <span class="optional">(optional)</span></label>
            <input type="email" id="email" name="email" placeholder="your@email.com">
          </div>

          <div class="form-group">
            <label for="suggestion">Your Suggestion <span class="required">*</span></label>
            <textarea id="suggestion" name="suggestion" rows="4" placeholder="Share your ideas, product requests, or feedback..." required></textarea>
          </div>

          <button type="submit" class="btn btn-submit">Submit Suggestion</button>
        </form>
        <div class="thank-you-message" id="thankYouMessage" style="display: none;">
          <div class="thank-you-icon">‚úì</div>
          <h3>Thank You for Your Feedback!</h3>
          <p>Your suggestion has been received and will be reviewed by our team.</p>
          <button class="btn btn-another" id="submitAnother">Submit Another Suggestion</button>
        </div>
      </div>
    </div>
  </section>

  <script define:vars={{ formspreeEndpoint }}>
    const form = document.getElementById('suggestionForm');
    const thankYouMessage = document.getElementById('thankYouMessage');
    const submitAnotherBtn = document.getElementById('submitAnother');
    const submitBtn = form.querySelector('.btn-submit');

    form.addEventListener('submit', async function(e) {
      e.preventDefault();

      const suggestion = document.getElementById('suggestion').value;

      if (!suggestion.trim()) {
        alert('Please enter your suggestion');
        return;
      }

      // Disable button and show loading state
      submitBtn.disabled = true;
      submitBtn.textContent = 'Sending...';

      try {
        const formData = new FormData(form);

        const response = await fetch(formspreeEndpoint, {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        });

        if (response.ok) {
          // Clear form and show thank you message
          form.reset();
          form.style.display = 'none';
          thankYouMessage.style.display = 'block';
        } else {
          throw new Error('Form submission failed');
        }
      } catch (error) {
        alert('Sorry, there was an error sending your suggestion. Please try again.');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit Suggestion';
      }
    });

    submitAnotherBtn.addEventListener('click', function() {
      thankYouMessage.style.display = 'none';
      form.style.display = 'block';
    });
  </script>
</BaseLayout>

