---
import BaseLayout from '../layouts/BaseLayout.astro';
import '../styles/contact.css';

// IMPORTANT: Replace this with your actual Formspree form ID
// 1. Go to https://formspree.io and create a free account
// 2. Create a new form for "Contact Form"
// 3. Copy the form ID and replace 'YOUR_FORMSPREE_ID' below
const formspreeEndpoint = "https://formspree.io/f/xwvnreqa";
---

<BaseLayout title="Contact Us - Get in Touch">
  <section class="contact-hero">
    <div class="contact-hero-bg" style="background-image: url('https://images.unsplash.com/photo-1423666639041-f56000c27a9a?w=1920&h=600&fit=crop');"></div>
    <div class="contact-hero-overlay"></div>
    <div class="container contact-hero-content">
      <h1>Contact Us</h1>
      <p class="lead">We're here to help! Get in touch with any questions or inquiries.</p>
    </div>
  </section>

  <section class="contact-content section">
    <div class="container">
      <div class="contact-grid">
        <div class="contact-info">
          <h2>Get in Touch</h2>
          <p>
            Have questions about our products or need help with an order?
            We're here to assist you. Reach out through any of the channels below.
          </p>

          <div class="contact-methods">
            <div class="contact-method">
              <div class="method-icon">üìç</div>
              <div>
                <h4>Location</h4>
                <p>Yaound√©, Cameroon</p>
              </div>
            </div>
            <div class="contact-method whatsapp-method">
              <div class="method-icon">üí¨</div>
              <div>
                <h4>WhatsApp (Fastest Response)</h4>
                <a href="https://wa.me/237670358551" target="_blank" rel="noopener noreferrer" class="whatsapp-link">
                  +237 670 35 85 51
                </a>
              </div>
            </div>
          </div>

          <div class="business-hours">
            <h3>Business Hours</h3>
            <p><strong>Monday - Friday:</strong> 9:00 AM - 6:00 PM (CAT)</p>
            <p><strong>Saturday:</strong> 10:00 AM - 4:00 PM (CAT)</p>
            <p><strong>Sunday:</strong> Closed</p>
            <p class="hours-note">WhatsApp messages are checked throughout the day</p>
          </div>

          <div class="quick-contact">
            <h3>Quick Contact</h3>
            <a href="https://wa.me/237670358551?text=Hi%2C%20I%27m%20interested%20in%20your%20products.%20Can%20you%20help%20me%3F"
               target="_blank"
               rel="noopener noreferrer"
               class="btn whatsapp-btn">
              Chat on WhatsApp
            </a>
          </div>
        </div>

        <div class="contact-form-wrapper">
          <h2>Send Us a Message</h2>
          <form class="contact-form" id="contact-form" action={formspreeEndpoint} method="POST">
            <!-- Email subject line -->
            <input type="hidden" name="_subject" value="New Contact Form Message - American Select">

            <div class="form-group">
              <label for="name">Your Name *</label>
              <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
              <label for="email">Email Address *</label>
              <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
              <label for="phone">Phone / WhatsApp Number</label>
              <input type="tel" id="phone" name="phone" placeholder="+237 ...">
            </div>
            <div class="form-group">
              <label for="subject">Subject *</label>
              <select id="subject" name="subject" required>
                <option value="">Select a subject</option>
                <option value="Product Inquiry">Product Inquiry</option>
                <option value="Bulk Order">Bulk Order Request</option>
                <option value="Order Status">Order Status</option>
                <option value="General Question">General Question</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="form-group">
              <label for="message">Message *</label>
              <textarea id="message" name="message" rows="6" required placeholder="Tell us how we can help..."></textarea>
            </div>
            <!-- Honeypot field for spam protection -->
            <input type="text" name="_gotcha" style="display:none">
            <button type="submit" class="btn" id="contact-submit-btn">Send Message</button>
          </form>
          <div id="contact-success" style="display:none; text-align:center; padding: 2rem 1rem;">
            <h3 style="color: #28a745; margin-bottom: 1rem;">Message Sent!</h3>
            <p>Thank you for contacting American Select! We have received your message and will get back to you within 24 hours. For urgent inquiries, please contact us on WhatsApp at <a href="https://wa.me/237670358551">+237 670 35 85 51</a>.</p>
            <button class="btn" id="send-another-btn" style="margin-top: 1.5rem;">Send Another Message</button>
          </div>
          <p class="form-note" id="contact-form-note">We typically respond within 24 hours. For faster response, use WhatsApp.</p>
        </div>
      </div>

      <div id="faq" class="faq-section" style="margin-top: 4rem;">
        <h2 style="text-align: center; margin-bottom: 2rem;">Frequently Asked Questions</h2>
        <div class="faq-accordion">
          <details class="faq-item">
            <summary class="faq-question">
              <span>How long does shipping take?</span>
              <span class="faq-arrow">‚ñº</span>
            </summary>
            <p class="faq-answer">Typical shipping time from USA/Canada to Cameroon is 4-8 weeks depending on the shipping method and customs clearance.</p>
          </details>
          <details class="faq-item">
            <summary class="faq-question">
              <span>What payment methods do you accept?</span>
              <span class="faq-arrow">‚ñº</span>
            </summary>
            <p class="faq-answer">We accept various payment methods including bank transfers, mobile money, and cash on delivery (where available).</p>
          </details>
          <details class="faq-item">
            <summary class="faq-question">
              <span>Can I request specific products?</span>
              <span class="faq-arrow">‚ñº</span>
            </summary>
            <p class="faq-answer">Yes! If you don't see a product you need, contact us and we can add it to our next shipment.</p>
          </details>
          <details class="faq-item">
            <summary class="faq-question">
              <span>Do you offer delivery?</span>
              <span class="faq-arrow">‚ñº</span>
            </summary>
            <p class="faq-answer">Delivery services are not yet available, but we are developing plans to offer them in the near future.</p>
          </details>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<script>
  const form = document.getElementById('contact-form');
  const successMsg = document.getElementById('contact-success');
  const formNote = document.getElementById('contact-form-note');
  const submitBtn = document.getElementById('contact-submit-btn');
  const sendAnotherBtn = document.getElementById('send-another-btn');

  sendAnotherBtn?.addEventListener('click', () => {
    form.reset();
    successMsg.style.display = 'none';
    form.style.display = '';
    formNote.style.display = '';
    submitBtn.disabled = false;
    submitBtn.textContent = 'Send Message';
  });

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    submitBtn.disabled = true;
    submitBtn.textContent = 'Sending...';

    try {
      const res = await fetch(form.action, {
        method: 'POST',
        body: new FormData(form),
        headers: { 'Accept': 'application/json' }
      });

      if (res.ok) {
        form.style.display = 'none';
        formNote.style.display = 'none';
        successMsg.style.display = 'block';
      } else {
        alert('Something went wrong. Please try again.');
        submitBtn.disabled = false;
        submitBtn.textContent = 'Send Message';
      }
    } catch {
      alert('Something went wrong. Please try again.');
      submitBtn.disabled = false;
      submitBtn.textContent = 'Send Message';
    }
  });
</script>
